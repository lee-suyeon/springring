# 스프링 핵심 원리 이해 2 - 객체 지향의 원리

### 새로운 할인 정책 개발
* 정액 할인 ➡️ 정률 할인으로 변경


### 새로운 할인 정책 적용과 문제점
* 클래스 의존관계 분석
* OrderServiceImple
  * 추상(인터페이스) 의존 : DiscountPolicy
  * 구현 클래스 : FixDiscount, RateDiscount
```java
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy(); // *

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice); // 단일 책임 원칙

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```
* ⚠️DIP 위반 - 클라이언트인 `OrderServiceImpl`이 `DiscountPolicy` 인터페이스 뿐만 아니라 `FixDiscountPolicy`인 구현 클래스도 함께 의존하고 있다. 

* 추상에만 의존해야한다!!!!!
*  ⚠️OCP 위반 - `FixDiscountPolicy`를 `RateDiscountPolicy`로 변경하는 순간 `OrderServiceImpl`의 소스 코드도 함께 변경해야 한다.

**해결 방법**
* DIP를 위반하지 않도록 인터페이스에만 의존하도록 의존관계를 변경하면 된다. 
```java
    private final DiscountPolicy discountPolicy;
```
