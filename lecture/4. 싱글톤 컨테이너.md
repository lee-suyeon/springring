# 스프링 핵심 원리 이해 4 - 싱글톤 컨테이너

### 웹 어플리케이션과 싱글톤
* 웹 애플리케이션은 보통 여러 클라이언트가 동시에 요청한다.
  * 클라이언트 A : memberService 요청
  * DI컨테이너(AppConfig) : memberService
  * 스프링없는 순수한 DI 컨테이너인 AppConfig는 요청을 할 때마다 객체를 새로 생성한다. 
  * 고객 트래픽이 초당 100이 나오면 초당 100개 객체가 생성되고 소멸된다 -> 메모리 낭비
  * 해당 객체가 딱 1개만 생성되고 공유되도록 설계 -> 싱글톤 패턴
  
### 싱글톤 패턴
* 클래스의 인스턴스가 딱 1개만 생성되는 것을 보장하는 디자인 패턴
* `private`생성자를 사용해서 외부에서 임의로 `new`키워드를 사용하지 못하도록 막아야한다. 
```java
public class SingletonService { 
    
  // 1
  private static final SingletonService instance = new SingletonService();

  // 2
  public static SingletonService getInstance() {
    return instance;
  }
  
  public void logic() {
    System.out.println("싱글톤 객체 로직 호출");
  }
}
```
1. static영역에 객체 instance를 미리 하나 생성해서 올려둔다. 
2. 객체가 필요할 경우 getInstance()를 통해서만 조회 가능( 항상 같은 인스턴스 반환 )
3. 딱 1개의 객체 인스턴스만 존재해야 하므로, 생성자를 `private`으로 막아서 혹시라도 외부에서 new 키워드로 객체 인스턴스가 생성되는 것을 막는다.

**싱글톤 패턴 문제점**
* 싱글톤 패턴을 구현하는 코드 자체가 길어진다. 
* 의존관계상 클라이언트가 구체 클래스에 의존한다 ➡️ DIP를 위반한다.
* 클라이언트가 구체 클래스에 의존해서 OCP원칙을 위반할 가능성이 높다. 
* 테스트하기 어렵다. 
* 내부 속성을 변경하거나 초기화 하기 어렵다. 
* `private`생성자로 자식 클래스를 만들기 어렵다. 
* 유연성이 떨어진다. 
* 안티패턴으로 불리기도 한다. 
